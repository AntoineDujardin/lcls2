import numpy as np
import os




mb_per_img = 16
batch_size = 16

arr_size = mb_per_img*500000
def create_image():
    image = np.random.randint(0,2**16,size=(250,250,8*mb_per_img), dtype='uint16')
   # arr = np.tile(image,2*mb_per_img)
    arr = image.ravel()
    return arr

out_img = np.array([create_image() for x in range(batch_size)])



# mb_per_img = 1
# arr_size = mb_per_img*500000

# def create_image_bytes(mb_per_img):
#     image = np.random.randint(0,2**16,size=(250,250,4), dtype='uint16')
#     arr = np.tile(image,2*mb_per_img)
#     arr = arr.ravel()
#     return arr.tobytes()

def write_client():

    file_name = '/drp_dir/eliseo/data/xtc_lite/xtc_lite.xtc'
    os.remove(file_name)
    with open(file_name, 'wb') as f:
        ct = 0
        while True:
            f.write(out_img)
            ct+=1
            if ct%100 == 0:
                print('Wrote image %i' % ct)

write_client()
